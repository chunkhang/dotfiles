# vim: set foldmethod=marker:

# =============================================================================
# TPM {{{
# =============================================================================

# -----------------------------------------------------------------------------
# Plugin manager
# -----------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tpm'

# -----------------------------------------------------------------------------
# Appearance
# -----------------------------------------------------------------------------
set -g @plugin 'chunkhang/tmux-onedark-theme'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# -----------------------------------------------------------------------------
# Standards
# -----------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tmux-sensible'

# -----------------------------------------------------------------------------
# Sessions
# -----------------------------------------------------------------------------
set -g @plugin 'tmux-plugins/tmux-resurrect'

# -----------------------------------------------------------------------------
# Mouse
# -----------------------------------------------------------------------------
set -g @plugin 'nhdaly/tmux-better-mouse-mode'

# }}}
# =============================================================================
# BASIC {{{
# =============================================================================

# Terminal
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*-256color:Tc"

# Enable mouse support
set -g mouse on

# Start numbering from 1
set -g base-index 1
setw -g pane-base-index 1

# Do not rename windows automatically
set -g allow-rename off
set -g automatic-rename off

# Vi bindings for copy mode
setw -g mode-keys vi

# }}}
# =============================================================================
# MAPPINGS {{{
# =============================================================================

# -----------------------------------------------------------------------------
# Prefix
# -----------------------------------------------------------------------------
unbind C-b
set -g prefix `
bind ` send-prefix

# -----------------------------------------------------------------------------
# Servers
# -----------------------------------------------------------------------------
bind Q kill-server

# -----------------------------------------------------------------------------
# Windows
# -----------------------------------------------------------------------------
# Create
bind = new-window -c "#{pane_current_path}"
# Kill
bind - confirm-before -p "Kill window? (y/n)" kill-window
# Navigate
bind [ previous-window
bind ] next-window
bind \ last-window
# Swap
bind -r "<" swap-window -t -1
bind -r ">" swap-window -t +1

# -----------------------------------------------------------------------------
# Panes
# -----------------------------------------------------------------------------
# Navigate
bind j select-pane -D
bind k select-pane -U
bind h select-pane -L
bind l select-pane -R
# Split
bind up split-window -b -v -c "#{pane_current_path}"
bind down split-window -v -c "#{pane_current_path}"
bind left split-window -b -h -c "#{pane_current_path}"
bind right split-window -h -c "#{pane_current_path}"

# -----------------------------------------------------------------------------
# Copy mode
# -----------------------------------------------------------------------------
bind / copy-mode
bind -T copy-mode-vi 'v' send -X begin-selection
bind -T copy-mode-vi 'y' send -X copy-selection-and-cancel

# -----------------------------------------------------------------------------
# tmux-resurrect
# -----------------------------------------------------------------------------
bind D run-shell "#{@resurrect-save-script-path}" \; detach-client

# }}}
# =============================================================================
# PLUGINS {{{
# =============================================================================

# -----------------------------------------------------------------------------
# tmux-onedark-theme
# -----------------------------------------------------------------------------
set -g @onedark_time_format '%H:%M'
set -g @onedark_date_format '%a %d/%m'
set -g @onedark_widgets '#(pmset -g batt | grep -Eo "\d+%%")'

# -----------------------------------------------------------------------------
# tmux-prefix-highlight
# -----------------------------------------------------------------------------
set -g @prefix_highlight_prefix_prompt '*'

# -----------------------------------------------------------------------------
# tmux-resurrect
# -----------------------------------------------------------------------------
set -g @resurrect-processes 'false'

# -----------------------------------------------------------------------------
# tmux-better-mouse-mode
# -----------------------------------------------------------------------------
set -g @scroll-speed-num-lines-per-scroll '1'
set -g @emulate-scroll-for-no-mouse-alternate-buffer 'on'

# -----------------------------------------------------------------------------
# tpm
# -----------------------------------------------------------------------------
run -b '~/.tmux/plugins/tpm/tpm'

# }}}
# =============================================================================
